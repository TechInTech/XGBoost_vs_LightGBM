

{'n_train': 500000, 'max_depth': 5}
training XGBoost
CPU: 32.057435274124146 seconds
[02:09:18] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 6.540524244308472 seconds
[02:09:24] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 6.4276041984558105 seconds
GPU: 14.442196369171143 seconds
training LightGBM
LightGBM: 2.651005744934082 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.675191  0.675223  0.675223  0.675190  0.675153
15  0.536597  0.538657  0.538657  0.535447  0.537610
30  0.493034  0.489796  0.489796  0.486863  0.486444
45  0.462322  0.461254  0.461254  0.459293  0.459364
60  0.442771  0.443328  0.443328  0.437910  0.441772
75  0.425477  0.422786  0.422786  0.424098  0.421615
90  0.413267  0.407351  0.407351  0.411846  0.410013

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.675299  0.675327  0.675327  0.675297  0.675268
15  0.538473  0.540042  0.540042  0.537301  0.539124
30  0.495559  0.491851  0.491851  0.489146  0.488446
45  0.465404  0.463598  0.463598  0.462304  0.461791
60  0.446256  0.446067  0.446067  0.441530  0.444701
75  0.429533  0.426136  0.426136  0.428245  0.425115
90  0.417798  0.411187  0.411187  0.416406  0.414010

Leaf counts
    CPU  EQBIN_dw  EQBIN_lg  GPU  LGB
0    32        32        32   32   32
15   32        32        32   32   32
30   32        32        32   32   32
45   32        32        32   31   32
60   31        30        30   32   32
75   32        30        30   31   28
90   32        30        30   30   32

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f21  0.127435  0.132040  0.132040  0.128303  0.156353
f5   0.081883  0.077436  0.077436  0.082170  0.043974
f17  0.076128  0.068636  0.068636  0.066650  0.056225
f1   0.071211  0.074794  0.074794  0.071274  0.052770
f10  0.063945  0.061258  0.061258  0.061784  0.100232


{'n_train': 500000, 'max_depth': 10}
training XGBoost
CPU: 64.59946513175964 seconds
[02:10:53] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 26.522526741027832 seconds
[02:11:20] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 26.067513942718506 seconds
GPU: 26.80812907218933 seconds
training LightGBM
LightGBM: 7.1205010414123535 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.651613  0.651639  0.651639  0.651623  0.651586
15  0.390985  0.390788  0.390788  0.389886  0.391984
30  0.324399  0.324340  0.324340  0.324032  0.329694
45  0.289630  0.296892  0.296892  0.291126  0.295052
60  0.271698  0.274448  0.274448  0.270960  0.277323
75  0.257845  0.257760  0.257760  0.257121  0.257272
90  0.246034  0.244864  0.244864  0.246174  0.244574

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.652679  0.652533  0.652533  0.652668  0.652433
15  0.402273  0.401175  0.401175  0.400931  0.402386
30  0.341669  0.340391  0.340391  0.340796  0.345403
45  0.311990  0.316944  0.316944  0.312809  0.315874
60  0.297392  0.298326  0.298326  0.296331  0.301144
75  0.287060  0.285349  0.285349  0.285789  0.285180
90  0.278940  0.276250  0.276250  0.277813  0.276580

Leaf counts
    CPU  EQBIN_dw  EQBIN_lg  GPU  LGB
0   836       852       852  824  862
15  759       745       745  751  810
30  516       521       521  655  507
45  791       413       413  465  517
60  570       723       723  633  361
75  535       172       172  482  363
90  372       342       342  219  247

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f21  0.129604  0.129117  0.129117  0.132804  0.123567
f9   0.069124  0.069491  0.069491  0.070271  0.069129
f7   0.065873  0.063594  0.063594  0.064530  0.090088
f31  0.063052  0.062961  0.062961  0.064352  0.075394
f17  0.059523  0.058179  0.058179  0.060003  0.048433


{'n_train': 500000, 'max_depth': 15}
training XGBoost
CPU: 103.43675589561462 seconds
[02:14:07] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 94.24054670333862 seconds
[02:15:43] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 93.73049449920654 seconds
GPU: 41.41070795059204 seconds
training LightGBM
LightGBM: 42.12094020843506 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.633625  0.633882  0.633882  0.633891  0.634404
15  0.279298  0.281393  0.281393  0.280319  0.281813
30  0.187293  0.188958  0.188958  0.188500  0.188833
45  0.157437  0.161164  0.161164  0.159911  0.158404
60  0.147866  0.146568  0.146568  0.147798  0.143542
75  0.136176  0.134437  0.134437  0.139835  0.130330
90  0.124755  0.117677  0.117677  0.130844  0.118015

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.639471  0.639428  0.639428  0.639485  0.639519
15  0.332404  0.331964  0.331964  0.332894  0.331980
30  0.265577  0.264912  0.264912  0.265999  0.264140
45  0.247366  0.247136  0.247136  0.247731  0.245486
60  0.242682  0.239228  0.239228  0.241350  0.237733
75  0.238192  0.235107  0.235107  0.238719  0.234196
90  0.234744  0.231170  0.231170  0.235933  0.231590

Leaf counts
     CPU  EQBIN_dw  EQBIN_lg   GPU   LGB
0   6323      6423      6423  5828  6293
15  6109      5409      5409  5542  5371
30  3429      3025      3025  2760  3095
45  1950      1478      1478  1424  1615
60   882      1396      1396  2137   890
75  4254      1126      1126   716  1782
90   575      2916      2916  1963   814

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f21  0.107480  0.106565  0.106565  0.106854  0.107275
f31  0.065742  0.063228  0.063228  0.065129  0.074930
f9   0.062665  0.064596  0.064596  0.062636  0.062277
f7   0.057683  0.057057  0.057057  0.057102  0.072696
f30  0.056068  0.057364  0.057364  0.056160  0.046753


{'n_train': 1000000, 'max_depth': 5}
training XGBoost
CPU: 82.6049427986145 seconds
[02:20:18] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 11.63558053970337 seconds
[02:20:30] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 11.7485990524292 seconds
GPU: 32.30701303482056 seconds
training LightGBM
LightGBM: 5.699147939682007 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.670660  0.670712  0.670712  0.670658  0.670716
15  0.517748  0.519764  0.519764  0.517930  0.517691
30  0.462437  0.465616  0.465616  0.463004  0.459531
45  0.434855  0.437321  0.437321  0.435786  0.433729
60  0.415429  0.416064  0.416064  0.412405  0.412749
75  0.399301  0.401604  0.401604  0.398981  0.397813
90  0.387958  0.387141  0.387141  0.389781  0.387854

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.670760  0.670815  0.670815  0.670759  0.670812
15  0.518433  0.520467  0.520467  0.518580  0.518216
30  0.463768  0.466785  0.466785  0.464320  0.460664
45  0.436756  0.439002  0.439002  0.437576  0.435291
60  0.417817  0.418094  0.418094  0.414673  0.414679
75  0.402107  0.403941  0.403941  0.401599  0.400068
90  0.391019  0.389714  0.389714  0.392670  0.390379

Leaf counts
    CPU  EQBIN_dw  EQBIN_lg  GPU  LGB
0    32        32        32   32   32
15   32        32        32   32   32
30   32        32        32   32   32
45   32        32        32   32   32
60   32        32        32   32   32
75   32        32        32   32   32
90   32        29        29   31   32

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f23  0.152380  0.145318  0.145318  0.155980  0.142049
f15  0.115084  0.116695  0.116695  0.109124  0.126820
f27  0.094646  0.095922  0.095922  0.098956  0.072221
f26  0.079643  0.080331  0.080331  0.082559  0.091723
f12  0.075936  0.073030  0.073030  0.074634  0.061900


{'n_train': 1000000, 'max_depth': 10}
training XGBoost
CPU: 176.2351996898651 seconds
[02:24:17] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 38.95847749710083 seconds
[02:24:56] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 39.240514278411865 seconds
GPU: 61.232369899749756 seconds
training LightGBM
LightGBM: 15.172722101211548 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.651102  0.651142  0.651142  0.651142  0.651436
15  0.381912  0.383524  0.383524  0.382580  0.382134
30  0.305014  0.308016  0.308016  0.306319  0.307507
45  0.272425  0.274393  0.274393  0.271926  0.273624
60  0.254291  0.258309  0.258309  0.254455  0.257468
75  0.242400  0.246340  0.246340  0.242056  0.240089
90  0.232372  0.234777  0.234777  0.231125  0.228573

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.651926  0.651907  0.651907  0.651982  0.652211
15  0.390088  0.391024  0.391024  0.390810  0.389737
30  0.318358  0.320003  0.320003  0.319721  0.319741
45  0.289157  0.289681  0.289681  0.288811  0.289144
60  0.273720  0.275817  0.275817  0.273872  0.275270
75  0.264055  0.265776  0.265776  0.263859  0.260945
90  0.256038  0.256561  0.256561  0.255180  0.251771

Leaf counts
    CPU  EQBIN_dw  EQBIN_lg  GPU  LGB
0   915       921       921  914  930
15  932       887       887  908  937
30  876       853       853  712  737
45  713       605       605  450  711
60  710       606       606  626  558
75  659       807       807  744  502
90  632       524       524  435  265

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f23  0.123423  0.118859  0.118859  0.121641  0.108854
f15  0.107457  0.109684  0.109684  0.109103  0.097062
f27  0.088888  0.091682  0.091682  0.092210  0.060009
f26  0.079056  0.079292  0.079292  0.076253  0.071838
f12  0.063740  0.062056  0.062056  0.062304  0.054272


{'n_train': 1000000, 'max_depth': 15}
training XGBoost
CPU: 261.0106291770935 seconds
[02:31:18] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 157.55515599250793 seconds
[02:33:58] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 154.05831265449524 seconds
GPU: 91.2684235572815 seconds
training LightGBM
LightGBM: 71.05349588394165 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.634273  0.634418  0.634418  0.634490  0.634695
15  0.275242  0.277973  0.277973  0.275103  0.276178
30  0.185253  0.187036  0.187036  0.184606  0.186278
45  0.147993  0.151796  0.151796  0.151080  0.151746
60  0.132270  0.135743  0.135743  0.135214  0.135111
75  0.124072  0.126092  0.126092  0.129139  0.123663
90  0.119755  0.114368  0.114368  0.122278  0.114119

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.638483  0.638379  0.638379  0.638537  0.638457
15  0.316774  0.317402  0.317402  0.316485  0.315752
30  0.247661  0.247397  0.247397  0.246871  0.246858
45  0.224404  0.225187  0.225187  0.225710  0.225005
60  0.215630  0.216443  0.216443  0.217051  0.216037
75  0.212305  0.213225  0.213225  0.214620  0.212293
90  0.211289  0.209711  0.209711  0.212205  0.209765

Leaf counts
     CPU  EQBIN_dw  EQBIN_lg   GPU   LGB
0   8747      9049      9049  8095  8778
15  8399      7866      7866  8072  8996
30  5534      6273      6273  5864  6170
45  5815      3104      3104  3391  4348
60  3900      1795      1795  1025  3783
75   559      3364      3364   841  1848
90  1938      2919      2919  1373   947

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f23  0.107391  0.105758  0.105758  0.108659  0.096616
f15  0.092491  0.094531  0.094531  0.093982  0.088780
f27  0.074214  0.075284  0.075284  0.073623  0.053268
f26  0.065948  0.064339  0.064339  0.065648  0.060686
f31  0.057171  0.055773  0.055773  0.056613  0.075983


{'n_train': 2000000, 'max_depth': 5}
training XGBoost
CPU: 218.34984517097473 seconds
[02:43:18] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 21.825712203979492 seconds
[02:43:39] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 21.980937242507935 seconds
GPU: 71.63267302513123 seconds
training LightGBM
LightGBM: 11.229804277420044 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.668203  0.668197  0.668197  0.668201  0.668234
15  0.504056  0.502499  0.502499  0.504065  0.502151
30  0.455658  0.458417  0.458417  0.456751  0.458877
45  0.430887  0.428591  0.428591  0.432047  0.430302
60  0.411730  0.412420  0.412420  0.414661  0.412863
75  0.400520  0.397671  0.397671  0.399593  0.400973
90  0.386594  0.387534  0.387534  0.387715  0.385234

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.668277  0.668257  0.668257  0.668275  0.668298
15  0.505170  0.503355  0.503355  0.505169  0.503100
30  0.457301  0.459662  0.459662  0.458351  0.460329
45  0.432862  0.430273  0.430273  0.433978  0.432139
60  0.413981  0.414352  0.414352  0.416856  0.414964
75  0.403053  0.399917  0.399917  0.402068  0.403273
90  0.389264  0.389928  0.389928  0.390395  0.387718

Leaf counts
    CPU  EQBIN_dw  EQBIN_lg  GPU  LGB
0    32        32        32   32   32
15   32        32        32   32   32
30   32        32        32   32   32
45   32        32        32   32   32
60   31        32        32   29   30
75   32        31        31   32   29
90   32        27        27   32   32

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f3   0.134757  0.132506  0.132506  0.126541  0.126395
f29  0.094595  0.096810  0.096810  0.090711  0.093972
f16  0.087491  0.089042  0.089042  0.085207  0.082158
f2   0.071072  0.063125  0.063125  0.073111  0.061252
f12  0.070810  0.069586  0.069586  0.066648  0.059501


{'n_train': 2000000, 'max_depth': 10}
training XGBoost
CPU: 420.7629692554474 seconds
[02:52:26] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 60.30662393569946 seconds
[02:53:27] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 60.33070492744446 seconds
GPU: 140.22884893417358 seconds
training LightGBM
LightGBM: 30.5777690410614 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.648014  0.648192  0.648192  0.648010  0.648379
15  0.364606  0.364879  0.364879  0.365058  0.364446
30  0.289583  0.291926  0.291926  0.290872  0.291823
45  0.265371  0.270327  0.270327  0.265576  0.270107
60  0.252322  0.251356  0.251356  0.248960  0.253641
75  0.239627  0.239048  0.239048  0.238248  0.233877
90  0.226735  0.223576  0.223576  0.220102  0.225911

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.648568  0.648686  0.648686  0.648564  0.648877
15  0.370764  0.370408  0.370408  0.371205  0.369894
30  0.298902  0.300284  0.300284  0.300013  0.300043
45  0.276443  0.280182  0.280182  0.276387  0.279966
60  0.264604  0.262590  0.262590  0.261425  0.264837
75  0.253241  0.251719  0.251719  0.251919  0.246804
90  0.241818  0.237951  0.237951  0.235708  0.240006

Leaf counts
    CPU  EQBIN_dw  EQBIN_lg  GPU   LGB
0   986       985       985  974   993
15  992       985       985  988  1005
30  914       858       858  847   930
45  463       545       545  887   891
60  399       428       428  519   598
75  378       841       841  841   401
90  654       819       819  804   460

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f3   0.141096  0.148919  0.148919  0.140806  0.102405
f16  0.100373  0.096085  0.096085  0.095854  0.079717
f29  0.098461  0.099831  0.099831  0.099198  0.091483
f24  0.068807  0.069015  0.069015  0.068904  0.122933
f31  0.062835  0.060524  0.060524  0.060424  0.036404


{'n_train': 2000000, 'max_depth': 15}
training XGBoost
CPU: 743.3113613128662 seconds
[03:09:49] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_dw: 230.50780200958252 seconds
[03:13:42] Tree method is selected to be 'hist', which uses histogram aggregation for faster training. Using custom sequence of updaters: grow_fast_histmaker
EQBIN_lg: 234.36232900619507 seconds
GPU: 206.5446901321411 seconds
training LightGBM
LightGBM: 119.2542724609375 seconds

binary_logloss train
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.630768  0.630933  0.630933  0.630895  0.631260
15  0.261406  0.262745  0.262745  0.261840  0.264909
30  0.177540  0.178629  0.178629  0.175796  0.178704
45  0.151335  0.149653  0.149653  0.149751  0.148595
60  0.139740  0.137552  0.137552  0.133271  0.133841
75  0.129299  0.123648  0.123648  0.127589  0.123482
90  0.122277  0.116654  0.116654  0.119911  0.114254

binary_logloss valid
         CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
0   0.633824  0.633762  0.633762  0.633863  0.634015
15  0.291654  0.291556  0.291556  0.291889  0.292659
30  0.221436  0.220845  0.220845  0.220195  0.220266
45  0.202997  0.200232  0.200232  0.202074  0.199034
60  0.195090  0.192587  0.192587  0.191511  0.190037
75  0.189405  0.185850  0.185850  0.188371  0.185445
90  0.186554  0.183244  0.183244  0.184490  0.182231

Leaf counts
      CPU  EQBIN_dw  EQBIN_lg    GPU    LGB
0   12306     12370     12370  11401  12192
15  12144     11097     11097   9922  11072
30   7569      6847      6847   7446   9032
45   5922      5307      5307   6339   5143
60   1542      2695      2695   6436   1572
75   6643      3224      3224    778   4637
90   2961       981       981   1539   4613

Feature importance(gain) sorted by CPU
          CPU  EQBIN_dw  EQBIN_lg       GPU       LGB
f3   0.116539  0.119025  0.119025  0.118934  0.093498
f29  0.086052  0.085851  0.085851  0.086027  0.082928
f16  0.085999  0.084129  0.084129  0.084999  0.073475
f24  0.072985  0.072988  0.072988  0.073392  0.116750
f8   0.060759  0.060173  0.060173  0.061463  0.088403


                  Time(sec)                                   Ratio  \
                        CPU EQBIN_dw EQBIN_lg    GPU    LGB CPU/LGB   
n_train max_depth                                                     
500000  5              32.1      6.5      6.4   14.4    2.7    12.1   
        10             64.6     26.5     26.1   26.8    7.1     9.1   
        15            103.4     94.2     93.7   41.4   42.1     2.5   
1000000 5              82.6     11.6     11.7   32.3    5.7    14.5   
        10            176.2     39.0     39.2   61.2   15.2    11.6   
        15            261.0    157.6    154.1   91.3   71.1     3.7   
2000000 5             218.3     21.8     22.0   71.6   11.2    19.4   
        10            420.8     60.3     60.3  140.2   30.6    13.8   
        15            743.3    230.5    234.4  206.5  119.3     6.2   

                                                     
                  EQBIN_dw/LGB EQBIN_lg/LGB GPU/LGB  
n_train max_depth                                    
500000  5                  2.5          2.4     5.4  
        10                 3.7          3.7     3.8  
        15                 2.2          2.2     1.0  
1000000 5                  2.0          2.1     5.7  
        10                 2.6          2.6     4.0  
        15                 2.2          2.2     1.3  
2000000 5                  1.9          2.0     6.4  
        10                 2.0          2.0     4.6  
        15                 1.9          2.0     1.7  

Logloss
                       CPU  EQBIN_dw  EQBIN_lg      GPU      LGB  EQBIN_lg-LGB  CPU-GPU
n_train max_depth                                                                      
500000  5          0.41211   0.40130   0.40130  0.40914  0.40684      -0.00554  0.00297
        10         0.27344   0.27221   0.27221  0.27172  0.27255      -0.00034  0.00172
        15         0.23451   0.23004   0.23004  0.23499  0.22925       0.00079 -0.00048
1000000 5          0.38572   0.38365   0.38365  0.38489  0.38332       0.00033  0.00083
        10         0.25409   0.25140   0.25140  0.25184  0.24728       0.00412  0.00225
        15         0.21071   0.20795   0.20795  0.21131  0.20929      -0.00134 -0.00059
2000000 5          0.38389   0.38377   0.38377  0.38338  0.38279       0.00097  0.00051
        10         0.23623   0.23234   0.23234  0.23034  0.23107       0.00127  0.00589
        15         0.18403   0.18010   0.18010  0.18393  0.18132      -0.00123  0.00010

Done: 4487.143693447113 seconds
